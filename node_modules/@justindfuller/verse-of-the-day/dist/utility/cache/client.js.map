{"version":3,"sources":["../../../src/utility/cache/client.js"],"names":["handleError","args","error","client","createClient","on","promisifyAll","RedisClient","prototype","Multi","e","console"],"mappings":";;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AAIA,SAASA,WAAT,GAA2C;AAAA;;AAAA,oCAAnBC,IAAmB;AAAnBA,QAAmB;AAAA;;AACzC,iCAAOC,KAAP,eAAa,aAAb,0CAA+BD,IAA/B;AACD;;AAED,IAAIE,eAAJ;;kBAEe,YAAM;AACnB,MAAIA,MAAJ,EAAY;AACV,WAAOA,MAAP;AACD;;AAED,MAAI;AACFA,aAAS,gBAAMC,YAAN,CAAmB,uBAAnB,CAAT;AACAD,WAAOE,EAAP,CAAU,OAAV,EAAmBL,WAAnB;AACAG,WAAOE,EAAP,CAAU,SAAV,EAAqBL,WAArB;AACA,uBAASM,YAAT,CAAsB,gBAAMC,WAAN,CAAkBC,SAAxC;AACA,uBAASF,YAAT,CAAsB,gBAAMG,KAAN,CAAYD,SAAlC;AACD,GAND,CAME,OAAOE,CAAP,EAAU;AACVC,YAAQT,KAAR,CAAc,kCAAd;AACD;;AAED,SAAOC,MAAP;AACD,C","file":"client.js","sourcesContent":["import redis from 'redis';\r\nimport bluebird from 'bluebird';\r\nimport config from './config';\r\nimport {\r\n  $log\r\n} from './../logging';\r\n\r\nfunction handleError(...args: any[]): void {\r\n  $log().error('Redis Error', ...args);\r\n}\r\n\r\nlet client;\r\n\r\nexport default () => {\r\n  if (client) {\r\n    return client;\r\n  }\r\n  \r\n  try {\r\n    client = redis.createClient(config());\r\n    client.on('error', handleError);\r\n    client.on('warning', handleError);\r\n    bluebird.promisifyAll(redis.RedisClient.prototype);\r\n    bluebird.promisifyAll(redis.Multi.prototype);\r\n  } catch (e) {\r\n    console.error('Unable to start up redis client.');\r\n  }\r\n\r\n  return client;\r\n};"]}