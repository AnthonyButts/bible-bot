{"version":3,"sources":["../../../src/utility/cache/client.spec.js"],"names":["t","redis","createClient","stub","client","on","spy","onFirstCall","returns","true","calledWith","called","event","f","notThrows"],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,mBAAK,+CAAL,EAAsD,UAACA,CAAD,EAAO;AAC3D,MAAMC,QAAQ;AACZC,kBAAc,gBAAMC,IAAN;AADF,GAAd;AAGA,MAAMC,SAAS;AACbC,QAAI,gBAAMC,GAAN;AADS,GAAf;AAGAL,QAAMC,YAAN,CAAmBK,WAAnB,GAAiCC,OAAjC,CAAyCJ,MAAzC;AACA,4BAAW,UAAX,EAAuB;AACrBH;AADqB,GAAvB;AAGAD,IAAES,IAAF,CAAOR,MAAMC,YAAN,CAAmBQ,UAAnB,CAA8B,uBAA9B,CAAP;AACAV,IAAES,IAAF,CAAOL,OAAOC,EAAP,CAAUM,MAAjB;AACD,CAbD;;AAeA,mBAAK,kDAAL,EAAyD,UAACX,CAAD,EAAO;AAC9D,MAAMC,QAAQ;AACZC,kBAAc,gBAAMC,IAAN;AADF,GAAd;AAGA,MAAMC,SAAS;AACbC,QAAI,YAACO,KAAD,EAAQC,CAAR;AAAA,aAAcb,EAAEc,SAAF,CAAYD,CAAZ,CAAd;AAAA;AADS,GAAf;AAGAZ,QAAMC,YAAN,CAAmBK,WAAnB,GAAiCC,OAAjC,CAAyCJ,MAAzC;AACA,4BAAW,UAAX,EAAuB;AACrBH;AADqB,GAAvB;AAGD,CAXD","file":"client.spec.js","sourcesContent":["import test from 'ava';\r\nimport sinon from 'sinon';\r\nimport proxyquire from 'proxyquire';\r\nimport config from './config';\r\n\r\ntest('Client calls createClient and on error event.', (t) => {\r\n  const redis = {\r\n    createClient: sinon.stub(),\r\n  };\r\n  const client = {\r\n    on: sinon.spy(),\r\n  };\r\n  redis.createClient.onFirstCall().returns(client);\r\n  proxyquire('./client', {\r\n    redis,\r\n  });\r\n  t.true(redis.createClient.calledWith(config()));\r\n  t.true(client.on.called);\r\n});\r\n\r\ntest('The callback to on error does not throw an error', (t) => {\r\n  const redis = {\r\n    createClient: sinon.stub(),\r\n  };\r\n  const client = {\r\n    on: (event, f) => t.notThrows(f),\r\n  };\r\n  redis.createClient.onFirstCall().returns(client);\r\n  proxyquire('./client', {\r\n    redis,\r\n  });\r\n});\r\n"]}